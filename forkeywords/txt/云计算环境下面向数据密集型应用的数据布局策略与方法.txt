


l

引目

随着信息技术的发展和普及，互联网逐渐成为

和可用性．基于云计算的大型网络应用呈现出分布、

异构的特点和数据密集的趋势，如科学工作流系统，

这类应用被称为数据密集型应用【1]．目前数据密集
型应用已被广泛应用于天文学[2]、高能物理学¨J以

一种计算平台．云计算是一种典型的网络计算模式，

及生物信息学[41等领域．这类应用的数据密集性主

强调在虚拟计算环境下运行大规模应用的可伸缩性

要体现在其处理的数据大小通常达TB甚至PB级，


其中既有已存在的输人数据源，也有在对数据进行
分析和处理的过程中产生的中间数据和最终结果数

最后一节，将对本文工作进行总结并对后续研究进
行展望．

据，而通过使用流程管理技术，可以实现这类数据密
集型应用的自动化执行．数据密集型应用，尤其是那

些面向流程的数据密集型应用，在利用云计算环境
的过程中遇到了一些新的挑战，特别是在数据布局

2 相关工作

本节首先简要介绍当前云计算环境下的数据管

方面尤为突出．在云计算环境下部署并执行数据密
集型应用，需要多数据中心的协作，因此在多数据中

理系统；然后阐述几种数据密集型应用系统的数据
管理策略；之后介绍目前关于数据依赖性的研究；最

心环境下如何为大量数据选择合适的存放位置变得
至关重要，具体表现为：(1)面对云环境下的多数据

后，介绍当前针对云计算环境下数据密集型应用的
数据布局问题的相关研究，并指出其局限性．

中心，这些应用在其执行过程中不可避免地需要进
行跨数据中心的数据传输．一方面数据规模巨大而

随着云计算日益受到蕈视，目前出现了一些
云计算环境下的数据管理系统，例如Google File

数据中心间网络带宽有限，另一方面存在一些数据
只能被存放于指定的数据中心而不能被移动，故数

System[5]和Hadoopif)，二者均对用户隐藏了用于存
储应用数据的基础设施．Google File System主要

据中心问的数据传输成为一个挑战．(2)这类应用
的流程特性决定了其数据之间存在数据依赖关系．

在多数据中心环境下，合理的数据布局方案应力求
保持这种数据间的依赖关系，这将利于降低流程执

针对Web搜索应用，而非云计算环境下的流程应

用．Hadoop则是一个更为通用的分布式文件系统，
包括Amazon和Facebook在内的许多公司使用该
系统．当Hadoop文件系统接收到一个文件时，系统

行过程中跨数据中心数据传输所导致的时间开销，
进而提升执行效率．(3)合理的数据布局方案，应在

会自动将该文件分为若干块，并将每个块随机放置
于某个集群中．此外，Cumulus项目[61提出了一个单

对应用执行效率进行优化的基础上，兼顾多数据中
心间的全局负载均衡．

数据中心环境的云架构．然而，上述云数据管理系统
并未针对云环境下数据密集型流程应用的数据布局

本文通过分析云计算环境下面向流程的数据密
集型应用的特点，在全面考虑数据传输次数、数据集

大小以及数据中心间网络带宽等因素的基础上，提
出云计算环境下面向数据密集璎应用的三阶段数据

布局策略，该策略的3个阶段分别针对跨数据中心
数据传输、数据问依赖关系和多数据中心间负载均

衡三个目标对数据布局方案进行求解和优化．该策
略一方面解决了多数据中心环境下大规模数据的布

局问题，降低了应用执行过程中跨数据中心数据传
输所导致的时间开销；另一方面，对数据集间的数据

依赖关系进行建模并依此对不同数据布局方案进行
评价和调整，以使数据布局方案尽可能符合数据集

间的依赖关系；此外，对不同的数据布局方案所对应
的负载均衡状况进行量化分析并依此对数据布局方

案进行筛选，从而在保证执行效率的基础上兼顾全
局的负载均衡．

问题进行相关研究．

常见的数据密集型流程应用系统都有其各自的

数据管理策略．在流程的构建阶段，这类策略主要针

对数据的建模，例如Kepler[3]使用了一种面向角色
的数据建模方法，用于网格环境下的大规模数据建
模；TavernaE43和ASKALON[71则分别采用了各自

的流程定义语言来表示其数据流．在流程的执行阶

段，大部分系统采用某种数据网格来对数据进行管
理，例如Kepler使用了SRB[8]系统，Pegasus[2]和

TrianaE9]采用了RLS系统[1 0|．数据网格的主要作用
是为分布式环境下的数据密集型应用提供基础设施

与服务，以实现对分布存储资源中海量数据集的访
问、移动和修改[11|．然而，无论在流程的构建阶段还

是执行阶段，这些系统的数据管理策略都没有关注
数据的存放布局，既没有考虑数据间的依赖性，也无

法减少跨数据中心的数据移动．

本文第2节介绍相关工作，并在此基础上进一

当前已有一些研究注意到数据密集型流程应用

步阐明本文与相关工作的差异与研究意义；第3节
介绍云环境下数据密集型流程应用的数据布局问
题，并对相关概念进行建模；第4节介绍本文所提的

中的数据依赖性问题．Fileeules项目[123基于依赖关

系对文件进行分组，实验数据显示了其分组策略的
可用性和有效性．BitDew[13]将数据的依赖性定义为

三阶段数据布局管理策略以及数据布局方案的求解

数据的一个属性，该属性由用户进行预定义．然而，

与优化过程；第5节通过仿真实验将本文数据布局
策略与其它同类策略进行对比，并对结果进行分析；



云计算环境中的所有数据均位于各数据中心，因此

存储空间．DC中各数据中心间网络带宽矩阵表

由用户来定义数据间的依赖关系，对云计算环境下
的数据密集型应用而言是不现实的．此外，这些研究
虽然关注数据间的依赖性，但并未基于此来解决数

示为

据布局问题，也没有考虑跨数据中心数据传输的代
价问题．

针对云计算环境下面向流程的数据密集型应用
的数据布局管理问题，文献[14]提出了一种基于聚
类矩阵的数据布局策略，用于多数据中心环境下数

据布局方案的求解和优化．该方法首先将流程应用
的所有输入数据构建为依赖矩阵，再利用BEA[153算
法对依赖矩阵进行聚类变换从而得到聚类矩阵，然

后基于聚类矩阵对所有数据集组成的集合进行划
分，并分别为所得每个划分分配存放位置．实验证明

该策略能够减少云计算环境下流程应用执行过程中
的跨数据中心数据传输的总次数．然而，数据传输总

次数的减少并不一定意味着执行效率的提高，因为
每次所传输数据量的大小并不一定相同，且遍布
Internet的各数据中心两两之间的网络带宽也不一

定相同，即执行过程中跨数据中心数据传输总次数
的减少，并不能等同于数据传输所导致时间开销的

减少．

综上所述，虽然针对云数据管理和流程密集型
应用数据管理的研究较多，但关于云计算环境下数

据密集型流程应用的数据布局问题的研究较少，当
前少数针对该问题的研究也存在一定的局限性，即

只关注跨数据中心数据传输的次数，而忽视了所传
输数据量大小、各数据中心间的网络带宽差异等因

素，因此难以对跨数据中心数据传输所导致的时间
开销进行有针对性的优化并进而提高流程应用的执
行效率．

3问题描述与建模

对Vi，J—l，2，…，IDCI且i≠J，B中元素b“表示数
据中心dc，和dc，之间的网络带宽值．本文假设各数

据中心间网络带宽值可知并忽略其实时波动．
3．2面向流程的数据密集型应用

定义2． 将面向流程的数据密集型应用定义
为三元组P一(T，C，DS)．其中T是P中所有任务

的集合；C是各任务间的控制流的集合；DS是P中
所有数据集的集合．

对流程应用中的单个任务，本文只关注其输入

数据集与输出数据集，定义如下．

定义3． 将面向流程的数据密集型应用P一

<T，C，DS)中的单个任务定义为二元组ti一(IDS，，
ODSi>，i—l，2，…，I TI．其中IDS，是任务t。的输入

数据集组成的集合；ODSi是任务ti的输出数据集组
成的集合．

有些数据集只允许被存放在指定的数据中心，本
文将其称为固定位置数据集，并将DS中所有固定位

置数据集组成的集合记为DS，h，对Vdi∈DSm，记
d，的指定存放位置的数据中心编号为fix(di)；而允

许被存放于任意数据中心的数据集则被称为可变位
置数据集，记DS中所有可变位置数据集组成的集

合为DS m：．

按数据集的产生时间，又可将数据集分为初始
数据集和生成数据集．作为流程应用的初始输入数

据而在流程执行前已存在的数据集，本文将其称为

初始数据集，并将DS中所有初始数据集组成的集
合记为DS谢；而在执行过程中产生的数据集则被称
为生成数据集，DS中所有生成数据集组成的集合

本节将对云计算环境下数据密集型流程应用的

被记为DS。．

数据布局问题的相关概念进行建模，具体包括云计
算环境、面向流程的数据密集型应用、单次数据传输
时间开销和全局数据传输时间开销．

3．1云计算环境

云计算环境由多个分布的数据中心组成．由于

本文研究重点为云计算环境下的数据布局问题，故
本文仅关注其存储资源和网络带宽．

定义1． 将云计算环境表示为多个分布式数

据中心组成的集合DC=

U

{d‘}．其中出。表

对DS中的单个数据集，本文只关注其大小、固

定存放位置和来源，定义如下．

定义4． 将面向流程的数据密集型应用P一

<T，C，DS>中的单个数据集定义为三元组di一
<dsi，lc，，gt；>，i=1，2，…，I DS I．其中d只是数据集
d。的大小；lc，和∥，的取值如下：

．
结合图1中的两个简单示例说明本文对面向流

DS

i)，

d

示编号为i的数据中心，强表示数据中心出i的可用

程的数据密集型应用的建模．在图1(a)中：T一

8期

郑 湃等：云计算环境下面向数据密集型应用的数据布局策略与方法

1475

据集、源数据中心和目标数据中心．d&表示数据集

d。的大小；b。，表示数据中心如i和出』间的网络带
宽．此外，在跨数据中心的数据传输过程中存在着请

求、响应、建立连接、断开连接等步骤，也会造成一部
分时间开销，将其记为C甜考虑到云计算环境下面
向流程的数据密集型应用的数据规模巨大，而G，相

对较小，故本文忽略Ci，所代表的那部分与被传输数
据集大小无关的时间开销．因此，使用下面式(2)可

近似计算单个数据集单次跨数据中心传输所造成的

时间开销


3．4全局数据传输时间开销

定义5．在数据中心集合DC— U

f=1·2·…，IDCl



已知的云计算环境中，面向流程的数据密集型应用
P一<T，C，DS>的一个数据布局方案，是从集合DS

到集合DC的映射，使对Vd。∈DS，存在唯一dc，∈
DC与之对应．记P一(T，C，DS>的一个数据布局方

案为s，则有s— U

{d；一如f)，其中dc,∈

DC．对Vd；∈DS，记s(d；)为在给定数据布局方案s
中数据集di所对应存放位置的数据中心编号．

定义6．在数据中心集合DC=



已知的云计算环境中，面向流程的数据密集型应用

P=<T，C，DS>的一个数据布局方案s的全局跨数
据中心数据传输时间开销，是指在DS中所有数据
集按s进行布局的情况下，P的执行过程中由跨数


3．3单次数据传输时间开销

据中心数据传输所导致的时间开销．

云计算环境下，流程中每个任务要开始执行须
至少满足两个条件：(1)该任务被调度至某个数据

中心；(2)该任务的所有输入数据集均位于本地．因
此若一个任务的多个输入数据集位于不同的数据中

心，则须在任务开始执行前进行跨数据中心的数据
传输．关于任务调度策略已有许多相关研究且并非

本文重点，故本文基于将任务调度至数据中心比进
行跨数据中心数据传输所造成时间开销更小的假

设，将任务调度策略简化为：将任务调度至那个使执
行该任务所需跨数据中心数据传输所导致时间开销

最小的数据中心．

考虑单个数据集单次跨数据中心传输的情况．

设源数据中心、目标数据中心和目标数据集分别为
出；、dcj和d。，则该次数据传输的时间开销可表示为

式(1)中d。，dci，dc，3个参数依次表示目标数

若已知数据中心集合DC、流程应用P一<T，C，

DS>和数据布局方案s，则可通过模拟流程应用的执
行过程来近似计算数据布局方案s的全局跨数据中

心数据传输所导致的时间开销．求解给定布局方案
的全局跨数据中心数据传输时间开销的近似计算算

法将在4．1．3节中给出．

4数据布局策略与求解方法

如图2所示，本文提出的数据布局求解方法的

过程可分为3个阶段：第1阶段，基于遗传算法求得

一组跨数据中心数据传输代价较小的数据布局方
案；第2阶段，计算第1阶段所得方案集合中各方案

的数据依赖关系破坏度，并依此对方案集进行调整；
第3阶段，对第2阶段所得方案集中的各方案的数

据中心负载均衡状况进行定量分析，并依此确定最
终的数据布局方案．

计

算

机

学

报

第2阶段

： 时间开销较少：

的办案集合

时间开销少且依赖：
破坏度低的方案集合：


图2 本文数据布局求解全过程流程图

4．1数据布局求解第1阶段

在数据布局求解的第l阶段，基于遗传算法求
解一组跨数据中心数据传输代价较小的数据布局方

案．下面针对云计算环境下面向流程的数据密集型
应用的数据布局问题，分别从编码规则、解的有效性

保证和解的评价函数3个方面对数据布局方案求解
过程的第1阶段进行介绍，并给出第1阶段求解

算法．
4．1．1编码规则

0001 0010 001l 0100 0101 01 lO 011 l 1000 100l 0000．
然而并非每个长度为I DS l×f logPl l的二进
制数都一定能表示一个数据布局方案的有效解．

4．1．2节中将讨论解的有效性问题与解的有效性保

证机制．
4。1．2解的有效性保证

根据不同的失效原因可将无效解分为3类，下

面分别说明，并给出对应的有效性保证机制．

第l类无效解．若解S的染色体中存在至少一

对云计算环境下的数据中心集合DC，面向流
程的数据密集型应用P一<T，C，DS>，数据布局方

个基因片段不能代表DC中的数据中心，则解s为

第l类无效解．根据4．1．1节中的编码规则，当IDCI

案求解第1阶段中解的编码规则如下：

对Ydc；∈DC，用I log：Dcl I位二进制数表示．具
体的，对i一1，2，…，|DC l一1，出，的编码为i的
rlog尸引]位二进制数；而编号为I DCI的数据中心所
对应的编码为Flog!Dcl位0．例如l DCI=10时，有
如下关系：

数据中心dc,dcz …dc9
编码0001

0010

…

1001

dc,o

0000

对DS中的每个数据集d，∈DS，用一个长度为
l-log；Dcl的数据中心编码表示其存放位置．对每个
数据布局方案，用I DSI×rlog!蚓]位二进制数表
示：对i一1，2，…，I DS I，染色体左侧第i个长度为
flog：Dcl的基因片段表示数据集d。存放位置的数据
中心编号．例如，当I DC l—I DS I一10时，“将数据

集d。存放于数据中心如，”这一数据布局方案所对
应的编码为

满足rlog!Dcrl≠log!Dcl时，则存在I DCl至2F104州]一

1共2F崦r1 I—I DCl个二进制数不能代表DC中的

数据中心，记这些二进制数的集合为FSfDcI，记解s

的染色体中所有I DSl个基因片段所对应的二进制

数的集合为PS，，则有

PS，n FSl蚓≠彩，则s无效

(3)

在初始布局方案的生成阶段、遗传过程中的交

叉、变异阶段，用式(3)对每个新产生的解进行判断，
若式(3)成立则淘汰该解．

第2类无效解．若解s所表示的数据布局方案

使至少一个数据中心在流程开始执行前已处于超负
荷状态，则解s为第2类无效解．为保证数据中心的

正常运转，通常为数据中心设置一个经验参数A，若
数据中心的使用率不小于A，则认为该数据中心处

于超负荷状态．如3．4节所述，s(di)表示在解s所

代表的数据布局方案中数据集di存放位置的数据

8期

郑 湃等：云计算环境下面向数据密集型应用的数据布局策略与方法

1477

中心编号，则有



在初始布局方案的生成阶段、遗传过程中的交
叉、变异阶段，用式(4)对每个新产生的解进行判断，

若式(4)成立则淘汰该解．

第3类无效解．若在解S所表示的数据布局方
案中，至少存在一个固定位置数据集的存放位置与

其指定位置不同，则解5为第3类无效解．

j Yd。∈DS，扫，使允≠o且址≠s(d；)，则s无效

(5)

本文对第3类无效解处理策略如下：设P一
<T，C，DS)满足DSk≠乃，则在生成初始解空间的

过程中，将每个解的染色体中所有代表d；∈DS佑存

放位置的基因片段按d；的下标升序依次与染色体

左侧第一个代表d；∈DS胁存放位置的基因片段交
换位置，于是所有代表固定位置数据集位置的基因

片段将按其下标升序依次分布于染色体左侧，而染
色体的其余部分则表示所有可变位置数据集的存放

位置．通过对染色体进行上述基因片段的位置变换
操作，可保证在交叉和变异阶段不产生第3类无

效解．

7．

8．

9．

10．

记第i个分支对应的子流程为P；；

递归计算TimeCost。．I(DC，Pf，s)，结果记为

costi；

cost---一cost+max{COSti)；

令t7为t对应的合并任务，将t7以及t与t 7问所

有任务从TASK中除去，并令t为t 7在C中的

后继任务；

1
按3．3节所述任务调度策略为t选择执行位

置，记该数据中心下标为i；

for(t的IDS中每个满足s(西)≠i的数据集以)

cost

COSt+ds,／b(s(Z)，i)；

令t为t在C中的后继任务；

13．

14．

15．

16．Return(cost)；

算法1以“将任务调度至使执行该任务所需跨

数据中心数据传输所导致时间开销最小的数据中
心”为任务调度策略．若使用其它任务调度策略，只

需对算法1稍作修改．

算法1虽然只能近似计算给定数据布局方案的

数据传输时间开销，但其结果能够反映不同数据布
局方案所对应跨数据中心数据传输时间开销的差异

与变化趋势，因此算法1结果的不精确性并不影响
利用其对不同的数据布局方案进行评价和比较．

4．1．4数据布局求解第1阶段算法

记对P一<T，C，DS)的数据布局方案的解所进行

的上述基因片段位置变换为Swap(P)；记Swap(P)
的逆变换为Swap_1(P)．

算法2． 数据布局方案求解第l阶段算法．

输入：DC，B，P一<T，C，DS>，数据布局方案s

输出：时间开销较优的数据布局方案集合(CH)

4．1．3数据布局方案的评价算法

主要步骤：

本文所提的数据布局策略的根本目的在于降低

1．初始化：定义变量popSize，genSize，mazGen；

云计算环境下面向流程的数据密集型应用在其执行
过程中由跨数据中心数据传输所导致的时间开销，

故本文以每个数据布局方案所对应的全局数据传输
代价的近似值作为布局方案的评价函数，记数据布

局方案的评价函数g(s)一TimeCost。划(DC，P，s)．

对给定的数据中心集合DC、流程应用P一

<T，C，DS)和数据布局方案s，可通过算法1求得s

对应的数据传输时间开销的近似值，即g(s)值．

算法1． 数据布局方案的时间开销近似算法．
输入：DC，B，P一<T，C，DS>，数据布局方案5

输出：s的时间开销近似值TimeCostt洲(DC，P，s)

主要步骤：

1．初始化：令cost

0，TASK为P中所有任务的集合，

2．对S进行4．1．2节所述的Swap_1(P)变换；

3．令t为P的第一个任务，并将其从TASK中除去；

4．while(TASK≠彰)

5．

6．

if(￡是分支任务)

for(每个分支)

2．令i一1；

3．while(i<，一popSize)

4． 生成随机布局方案s；

5．

if(5有效且不在CH中)／／用式(3)～(5)进行判断

6． 用算法1近似计算s的时间开销；

7．

对s进行4．1．2节所述的Swap(P)变换；

8． 将s加入CH，i++；

9．令cutGen

0；

10．while(curGen<maxGen)

11．for(CH中的每个解s)

12．

13．

14．

15．

16．

17．

18．

if(random(O，1)<变异率mr)

在s中对应DS，z。的部分随机选择变异位置户；

在位置P对s进行变异，记所得为s7；

对解s7进行Swap_1(P)变换，记所得为，；

if(，无效或s 7在CH中)

／／用式(3)～(4)进行判断

goto 13；

用s7替换5，并用算法1重新计算s的时问开销；

19．计算CH中每个解的被选中概率；

1478

计

算

机

学

报

2010年

／／使用轮盘赌算法

本文数据布局方案求解方法第2阶段的具体步

20．令j一0；

21．while(true)

22． 依各解的被选中概率从CH中选两个不同解

s1，s2；

if(random(O，1)<交叉率cr)

在s中对应DSs“的部分随机选择交叉位置q，
在位置q对s1与52进行交叉，记所得为s1 7，s2 7；

骤如下：

(1)记S㈨中各数据布局方案的全局数据传输
时间开销最小值为timeCost。i。，在S(1)中选择所有

数据传输时间开销值小于timeCost。i。X(1+A。)的

方案，记这些方案组成的集合为S矗，．这里的A。是
一个百分比参数，可根据具体需求调整，本文实验中

for(，zs—sl 7，s2 7)

取Ad—o，5％．

对咒s进行Swap-1(P)变换，记所得为r／$7；

(2)使用式(6)与式(7)计算S矗，中的每个方案

23．

24．

25．

26．

27．

28．

29．

30．

31．

if(珂57有效且咒s不在CH中)

将7l$加入CH，并用算法1计算其时间开销}

／／用式(3)～(4)判断

J++；

if(j一一genSize)goto 32；

32．将CH按各解对应时间开销的升序排序；

33．从CH中除去后面genSize个解，cuTfren++；

34．对CH中每个解进行Swap-1(P)变换；

35．Return(CH)；

算法2返回的结果是一组跨数据中心数据传输

时间开销较优的数据布局方案的集合，该集合中各
方案按其所对应时间开销的升序排列．算法2所得

即为本文数据布局方案求解方法第l阶段的结果，
记为5㈣．
4．2数据布局求解第2阶段

本文数据布局方案求解方法的第2阶段，将基
于数据集之间的依赖关系对S㈤中的各方案进行评

价和调整．下面给出数据集间的依赖度与数据布局
方案的依赖关系破坏度的定义．

定义7． 面向流程的数据密集型应用P一(T，
C，DS)，对Yd；∈DS，记T；为T中所有以d，作为输

入数据集的任务的集合；对Ydi，dj∈DS，将d：和d，
之间的数据依赖度记为denp(i，』)，则对Vi≠歹有

denp(i，J)一

f T，n TJ I×min{dsi，d彤)，di，dj硭Ds位
|I正n TJ I×dsf，di售DSri：且d，∈DS，h
I|Tl n TJ I×do，di∈DSI=且d，∈Ds伽
【0，

破，dj∈Dsm

(6)

定义8． s是面向流程的数据密集型应用P一
<T，C，DS>的一个数据布局方案，s的数据依赖破坏

度记为denp—damage(s)，则有
denp—damagP(s)一∑denp(i，歹)Xdist(i，J)

的数据依赖破坏度值，并按其升序对S矗，中所有数
据布局方案进行排序，所得结果即为本文数据布局
方案求解方法第2阶段的结果，记为S。：，．

4．3数据布局求解第3阶段

在本文数据布局方案求解方法的第3阶段，将

分别计算S㈤中各方案的负载均衡性能，并依此对
各布局方案进行评价和筛选．

(1)记S㈣中各数据布局方案数据依赖破坏度
最小值为damage。i。，在S㈤中选择所有数据依赖破
坏度值小于damage。；。×(1+A，)的方案，记这些方

案所组成的集合为S己，．这里的A，是一个百分比参
数，可根据具体需求调整，本文实验中取A，一1％．

(2)对S己，中的每个方案，分别计算其所对应的
各数据中心使用率的标准差，其中标准差最小的方

案即为本文数据布局方案求解的最终结果．

5 仿真实验

5．1实验设置与环境

本节将对本文提出的三阶段数据布局策略(下

文简称本文策略)与文献[14]提出的聚类数据布局
策略(下文简称聚类策略)进行对比实验．对每个随
机生成的测试流程，分别使用本文策略与聚类策略

求得各自的数据布局方案，然后基于两个方案对流
程进行仿真执行，并记录该过程中的跨数据中心数

据传输次数和时间开销．5．2节图中所标注的数据，
均为运行1000个参数相同的随机生成测试流程所

得结果的平均值；图3与图5中所标注的时间开销
单位为模拟时间单位．

实验环境为Inter(R)Core(TM)2 Duo 2．93GHz，

RAM 3GB，硬盘320GB，100MB网络带宽．

5．2实验结果和分析

Vdi·dj∈DS

其中dist(i,j)一㈦嚣戡；．

如图3所示，随着输入数据集个数的增加，两种

(7)

数据布局策略所对应的跨数据中心数据传输所导致
的时间开销都呈明显上升趋势；本文策略对应的时

间开销明显低于聚类策略，且增速较缓．

8期

郑湃等：云计算环境下面向数据密集型应用的数据布局策略与方法



图3数据集数变化对时间开销的影响

如图4所示，随着输入数据集个数的增加，两种
数据布局策略所对应的跨数据中心数据传输次数都
呈明显上升趋势；与聚类策略相比，本文策略所对应

的数据传输次数略多，但二者差别非常小．

如图6所示，随着数据中心个数的增加，两种数

据布局策略所对应的跨数据中心数据传输次数都呈
上升趋势；与聚类策略相比，本文策略所对应的数据

传输次数略多，但二者差别非常小．

籁
《
察
迎
啦
籁

图6数据中心数变化对移动次数的影响

综上所述，对于流程应用执行过程中跨数据中
心数据传输的次数，特别是在数据集数较多以及数

据中心数较多的情况下，聚类策略所对应的传输次
数较本文策略略少，但二者差距较小；而对于流程应

用执行过程中跨数据中心数据传输所导致的时间开
销，本文策略明显优于聚类策略，且随着数据集数量

的增加，本文策略的优势有逐渐扩大的趋势．

6结论与未来工作

图4数据集数变化对移动次数的影响

本文首先指出，当前云计算环境下面向流程的

数据密集型应用在数据布局管理方面所遇到的挑

如图5所示，随着数据中心个数的增加，两种数

战，特别是跨数据中心数据传输所造成的不可忽视

据布局策略所对应的跨数据中心数据传输所导致的
时间开销都呈缓慢上升趋势；本文策略对应的时间

开销明显低于聚类策略．

的时间开销；然后通过对该问题进行分析、建模，并

在充分考虑数据移动次数、数据集大小以及网络带

宽等因素的基础上提出了兼顾时间开销、数据依赖
性和负载均衡三方面指标的数据布局策略与方法；

之后，通过与其它数据布局策略的对比实验，说明本

文的数据布局策略具有较好的性能，尤其是在降低

跨数据中心数据传输导致的时间开销方面，本文策
略的优势十分明显．

未来我们计划在以下方面进行进一步的研究：

首先，计划对本文数据布局方案求解过程第1阶段

中初始布局方案生成的环节进行优化，即基于一定

的约束条件生成较优的初始方案，以提高求解效率．
此外，本文目前主要针对云环境下单个流程应用的

数据中心数

数据布局问题进行研究，未来计划研究云计算环境

图5数据中心数变化对时间开销的影响

下多个数据密集型流程应用的数据布局管理策略．

