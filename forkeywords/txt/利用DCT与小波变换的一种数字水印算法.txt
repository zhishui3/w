

引言

近年来，随着数字通讯技术、计算机网络技术、信息压缩编码技术和超大规模的集成
电路(VLSI)技术的发展，人类在多媒体通信领域中的研究与应用也取得了巨大的进步。但
另一方面，数字技术的大量优点也为侵权者提供了种种便利。盗版的泛滥已经成为了一个
严重的社会经济问题。版权的保护不仅仅是数字作品版权所有者的要求，也是社会的要求。
提起“水印”，马上会使我们联想到纸币上的水印、纸张上的水印。这些传统的“水印”用
来证明纸币或纸张上内容的合法性。而数字水印则是用来证明一个数字产品的拥有权与真
实性，成为分辨真伪的～种手段。它们的不同之处在于，传统水印都是人眼可以看得见的，
而数字水印有的也可为人眼所见．但大多数是深藏于数字化产品(图片、音频、视频、文本
等)之中。人眼看不见，人耳听不到，即是不易感知的，只能用计算机来识别、读取。

从水印的应用角度来看，目前一般认为．水印必须具有以下特点：
(1)隐蔽性：水印的存在不能明显干扰被保护的数据。
(2)鲁棒性：水印必须难以被破坏和伪造。
(3)唯一性：加入的水印应该是唯一的被鉴定。
早期的数字水印算法利用的是空间域。以图像为例，可以嵌入在一幅图像的亮度、色
彩、轮廓或结构中，但它的缺点是经不住惨剪。本文提供了一种基于频域的水印的嵌入与
检测的算法。

1原理

1．1数字水印的处理过程

数字水印处理的过程一般包括数字水印的嵌入，数字媒体的传播和数字水印的检测3

—23—

个过程。经过对人眼视觉特性和图像失真对频谱影响的分析．我们提出水印信号应放到图
像对于人眼的感知最具有意义的区域中，同时采用频域处理的方法使水印信号分布到整幅
图像中。另外，为了加重嵌入图像频谱中水印信号的分量，在水印嵌入图像后利用空间视
觉掩蔽效应，使水印的感知性和鲁棒性有一个较好的折衷以平衡两者的矛盾。

由人眼视觉系统(Human Visual System，tlVS)调制转移函数的测试结果可知，人眼
视觉的空间频率响应具有低通(中频加强)特性，经过测试调制转移函数的一种可能的数
学表达式可用下式表示：

H(u，v)2=(1+O．05D2)exp[-(D／50)2]

其中

D 2=u 2+v

2

u和r是图像的数字频率。人眼对图像的中频分量最为敏感，因此如果修改这一部分的频谱
引起的失真较容易被人眼察觉。而高频区分量在对图像的各种处理中很容易丢失。我们知
道图像的能量大部分集中于低频区，把信号叠加在这些最强的分量上，～方面使人们感觉
不到水印的存在。另外一方面，消除水印的企图将会严重的破坏图像的质量，因此可以有
效的提高水印的鲁棒性。

本算法以随机产生的服从^，(O，1)正态分布的随机数作为水印信号。利用相似度测量

公式比较检测的水印和原水印的相似程度，对于人为的水印破解具有较强的抵抗力。

1．2水印信号的嵌入

水印信号的嵌入过程用下列算法描述：
首先对图像I进行小波变换。小波变换是将信号分解到时域和尺度域上，不同的尺度对
应不同的频率范围。小波变换中常用到近似和细节。近似表示信号的低频成分，而细节表
示的是高频成分。这样我们通过小波变换，可以有效的提取图像的低频成分。例如对
512×512标准图像做一次小波变换，提取分解后的近似分量得到256×256图像，我们用
D 7表示。

为了使加入的水印可以均匀分布在256×256的图像中．我们对该图像进行离散的DCT
变换，然后决定图像中感知最具有意义的频率部分．即DCT系数最大的分量，用向量y
表示。

构造长度为n服从Ⅳ(O．1)正态分布的随机数序作为水印信号x。应用式下式将水印

信号x嵌入到中y中，得到Vf’：

yf’2 yj(1帕日ff)

其中ai是比例系数，其大小决定了水印信号修改图像频谱的强度，在不影响图像质量的前
提下通常取0．1。

y，返回D 7得到D”，并计算反离散余弦变换IDCT，恢复图像到空域，获得嵌入水印

的图像。

这时候我们已经获得了加入水印的低频图像，然后做小波的重构获得与原来图像大小

相等、含有水印成分的图像J’。

．．24．．

，

』t

i

，，；f：，：一。●^

簟；f，，。f：：，。I!f

t。l，；，；{：f；．，。，‘；．

，．，，

1．3水印信号的恢复

用算法描述如下：
(1)计算具有水印信号图像的小波变换，此时的图像可能已经发生了一畸变，用v

表示。

(2)提取小波变换的近似信号，对其做DCT变换，用矿表示。
(3)计算原图像的小波变换，提取小波变换的近似信号做DCT变换．用y表示。
(4)分析水印加入的位置，应用下式恢复水印信号x’：

z=％}tI

(5)利用相似度公式，比较恢复出来的水印信号x’和原水印信号X的相似程度。
从相似度测量值即可判断图像中是否含有水印信号．从而达到版权保护的目的。

2水印算法的改进

(1)我们选取小波变换加DCT变换的目的是利用两种变换各自的特点，强水印的鲁棒
性和视觉的掩蔽性。小波分析和DCT都属于时频分析。传统的信号分析是建立在傅里叶
(Fourier)变换的基础上的。傅里叶分析是一种全局的变换，它要么完全在时域，要么完
全在频域。小波变换是一种信号的时间一尺度(时间一频率)分析方法，它具有多分辨率
分析(MultiresolutJon An山sis)的特点，而且在时频两域都有表征信号局部特征的能力。即
在低频部分有较高的频率分辨率和较低的时间分辨率，在高频部分有较高的时间分辨率和
较低的频率分辨率。我们知道，图像在传输的过程中，有很多的噪声干扰，通过小波的变
换，我们提取的是最低频的成分．这相当于一个低通的滤波器。这样比单纯的DcT变换提
取低频成分的做法抗干扰能力有很大的提高。另外一方面，小波信号仍然有时域的性质，
如果直接加入水印信号，不利于视觉的掩蔽效应，而且针对不同的图像，加入的位置也不
容易确定。这时我们利用DcT变换的优势．将水印信号加入DcT变换的系数中，然后做II)CT
变换，使水印均匀的分布在小波的低频信号里。最后通过小波的重构，得到一幅加入水印
的图像。

∑毛幸工i

洲五工‘卢菥，

笔者曾经傲过单独的DCT变换的算法研究。由于小波变换有低通滤波器的特性，通过
小波变换处理后的图像，更容易保存水印的信息成分，从而更有效的抵抗一些图像处理的
攻击方式。以打印扫描处理为例，同样的图像利用同样的打印机和扫描仪处理，本算法对
水印信号的检测值平均值在13到14左右．而单独的DCT变换处理的结果，对水印信号的
检测平均值只有10左右．本算法平均提高了3～4，性能的提高是明显的。

(2)水印序列长度的确定。水印序列的长度决定了水印分布到图像中的程度。从理论上
说，越大则水印对于图像的保护可以越好，特别是可以更好地防止人为对水印的破解。但

一25—

广i

r

，f!i●‘，，，●F；，，．，f．●0

是实验表明较大的n并没有起到这样的效果。因为增大^，则水印可能会嵌八到图像频率较
微弱的分量中，这些分量在图像失真中很容易损失，所以对于水印信息的保存没有作用，
相反可能会使水印的检测响应减小。

(3)水印必须是唯一的。为了检测嵌入水印的唯一性，同时产生了1000个与水印序列
同样长的服从Ⅳ(0，I)正态分布伪随机数进行相似度测量。水印所在位置的相似度测量值
比其它随机数相似度铡量值要太得多。水印所在处的响应为30左右，而其它随机数的响应
一般不超过5。因此可以确定，嵌入的水印是唯一确定的，一般不会出现随机产生的随机数
序列与水印相似的情况。所以采用实型的随机数序列作为水印是可行的。

(4)我们知道在恢复水印的公式中国对x 7的影响比较大。因为在经过了处理以后，原
图像的DCT系数和加入水印的图像DCT系数差别很大，而m往往又比较小．这样x’的
某些系数就比较大，这样就影响到相似性的检测。我们知道，服从Ⅳ(0，1)正态分布的随
机数的幅值几乎没有大于6的，因此我们将x’中大于6的分量去掉，这样再做相似性检测，
可以得到比较好的结果。

(5)针对彩色图像的研究。针对彩色图像添加水印所面临的特殊问题是：在满足黑自图
像基本特性的前提下，还要考虑不能由于嵌入水印，而造成RGB色彩比例变化。这样要求
可以视为“不可感知性”在彩色图像中的特殊要求。目前常见的做法是在RGB色彩空间处
理。通过分析RGB等3个色彩分量的频谱．选择嵌入水印的的色彩空间和嵌入水印的强度。
但这种处理方法容易造成偏色，视觉的掩蔽效应不好。

通过对灰度图像的研究，我们提出在YIQ色彩空间嵌入水印的新思路。在YIQ空间，
r分量表征彩色图像的亮度分量；而¨姐Q分量分别为彩色图像的色调和饱和度。所以在只
改变Y分量的情况下，而保持原始的门∞Q分量，不会造成色彩比例变化而产生的“变色”，
仅仅影响明暗度。这样可以类比灰度图像的处理方法，使复杂的彩色图像的水印嵌入和检
测可以简单等同于灰度图像的相应处理。在视觉上充分的利用了HVS的特性．且有效的保
护了嵌八的水印在攻击过程中的鲁棒性。两者有比较理想的结合。

3实验测试与结果

3．1噪声攻击后的水印检测

嵌入水印的图像加入gaussian和salt＆peppcr噪声后进行水印的检测，响应值为20左右

下降了不到30％。可以看到对于这种高频的噪声，本算法有根好的抗攻击能力。

lena原始图像

加入gaussian噪声

相似度检测

一26一

3．2滤波处理后的水印检测

嵌入水印的图像经过平滑滤波和wiener滤波后，响应值大于25。这类低通滤波的攻击

同样对该算法没有什么影响。

Lena麒她图像

滤波处理后的图像

相似度检测

3．3缩放处理后的水印检测

将加入水印后的图像用Photoshop缩小至原来图像的25％，然后恢复到原来图像的尺寸
太小．进行相似度检测，其响应为20以上，可见在数字域进行的缩放处理对水印的攻击没
有太大的影响。

Lena腺c!f}图像

缩放处理后的图像

相似度检测

3．4剪裁处理后的水印检测

水印图像的裁剪。对嵌入水印的图像进行裁剪．取图像太小的1／4，为了从其中恢复
出水印数据．将裁剪遗失的部分以原图像代替。即将含有水印的图像小块替换不含水印的
原图像的部分。在这样的情况下，水印检测的响应为7左右。这是因为75％的水印信号都
损失了，响应也下降了75％左右。

kna胀始酗像

翦训处理后的图像

相似度榆测

一27—

f；，《

，：；，；：f。，{：f，：

}{

3．5 ．IPEG处理后的水印检测

对水印图像经过JPEG压缩编码，压缩质量为10％，不作其他的处理，然后做相似度
的检测，其响应在23以上。压缩质量为5％的时候．图像的质量已经下降了很多，这时做
相似度的检测也能达到20左右，比较理论值下降了不到3dB。

Lena原始图像

JPEG处理后的|生l像

相似度检测

3．6打印扫描后的水印检测

含水印的图像经过打印和扫描后，作比例缩放变换到原图像的大小。图像经过这样的
D／A和AID变换后引入了较大的失真，特别是高频噪声较为明显。在这样的情况下，水印
的相似度检测响应为12以上，同样高于其它的随机数相似度检测的响应。

Lena原始图像

打印扫描处理后的图像

相似度检测

结论

目前数字水印的算法多局限于数字通信领域．针对打印扫描的算法并不多。这是因为
在打印扫描的处理过程中，信号的损失很严重，如何有效的保存水印信息是解决这类f日题
的关键。本算法利用小波分析与DCT变换相结合的方法，有效的解决了打印扫描的过程中
水印信号的保存，对一些标准的图像进行测试得到了较为理想的结果。同时，对于一般的
图像处理技术，诸如图像的放缩，图像的压缩，滤波等攻击方式，仍然有理想的检测结果。
不失为一种比较有效的数字水印的算法。

一鸽一

