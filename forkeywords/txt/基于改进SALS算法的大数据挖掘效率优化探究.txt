

一、引言

移动互联网时代，随着3G／4G的普及，网络建设速度的加快，以及大规模的数码设备
的使用，移动运营商业务和数据规模的扩张呈几何级增长【11。‘以某省的基本数据量为例，其
语音通话记录每天入库2．5T，SMS话单记录每天入库800G以上，Mc口信令数据每天20TB，
GN口信令数据每天8TB，警告、性能等数据每天约3TB。再计算通过机器设备、服务器、
软件自动产生的各类非人机会话数据，以非结构和半结构化形式呈现的数据已经远远超过了
传统关系型数据处理的能力范畴。

传统的RDBMs可以处理结构化数据，其缺点是系统孤立、数据量处理小，面对移动互
联网时代的数据暴增特点，IT系统的可扩展性、成本控制、数据有效性挖掘均需要通过低成
本的通用设备，通过构建“池化资源”并结合“大数据挖掘”能力来推进业务进展。

池化资源指通过运用虚拟化技术，将单个物理机器资源进行分割或者将多台物理机器资
源进行整合，充分利用物理机的处理能力，实现物理机的高效分配和利用【2】。大数据挖掘则
针对具有4v特点的海量数据进行压缩、去重、整理、交叉分析和对比，并结合关联、聚合
等传统数据挖掘技术对非结构化和半结构化的数据进行分析口J。本文通过对现有大数据挖掘
技术的分析比对，就其中涉及到数据查询的可优化部分做深入讨论。

现行的大数据挖掘技术

自大数据概念诞生以来，陆续出现了多种大数据挖掘处理技术，如果以处理的实时性来
分类，可以将大数据挖掘处理技术分为两类：1．实时类处理技术；2．批处理技术。实时类大
数据挖掘处理技术有Storm、S4【4】等，而批处理技术或者称为线下处理技术的典型代表则是
MapReduce。对于移动运营商来讲，实时处理能力固然重要，但是通过大批量的线下数据处
理找到潜在的商业契机、提升用户体体验、实施决策分析、精准营销推荐、运营效能提升、
创新商业模式等对于运营商来说更为重要。本文关注大数据批处理中现有技术的性能提升。
2．1 MPP架构新型数据库技术

MPP(Massive Pa怕…Processing)从构成上来讲，是由多个sMP服务器横向扩展组成的分
布式服务器集群【s】。但MPP架构并不是一种池化资源的大数据处理架构，集群中的每个节
点均访问本地资源，采用share Nothing结构，集群节点之间并不存在共享及互访问的问题，
而是通过统一的互联模块来调度、平衡节点负载和并行处理过程。架构如图2．1．1。

图2．1-1．MPP服务器架构图

2．2大数据一体机

大数据一体机是商业公司专门为处理大数据而设计的软硬件一体机，由集成服务器、存
储、操作系统、数据库软件、其它数据分析软件等统一封装在机箱内，经过商业公司对数据
处理流程进行优化，从而形成高性能的大数据处理能力。
2．21 Had∞p开源大数据技术

Hadoop技术框架是以MapReduce为核心的一个开源大数据处理框架，其架构如图2．3．1
所示。其中，最底层的HDFs为分布式文件系统，底层使用廉价x86进行冗余备份：MapReduce
分为map、shufrIe和reduce阶段16l，map阶段对处理数据进行分解映射，分开处理，shuffIe
阶段拽取mao阶段数据到reduce端，陀duce阶段对处理子集进行归约合并，得到处理结果；
HBase不同于传统的关系型数据库，是一种基于列的的分布式数据库。

图2．3—1．咿P服务器架构图

2．3小结

三种大数据挖掘处理技术各有特点，综合比较如下：根据CAP理论，在兼顾分区性、

一致性和分区可容忍性的情况下，MPP扩展能力有限，目前最多可以横向扩展奎500个节

61

点。并且MPP成本较高，以处理结构性重要数据为主。大数据一体机环境封闭，例如oracle
的ExtData，技术实现细节不清晰，在处理性能上难以做出横向对比，且成本高，这里暂不

做讨论。Hadoop以处理非结构化和半结构化数据为主，横向扩展能力达到1000节点以上，
并且支持厂家和社区庞大，成本低廉，是一项较好的大数据挖掘框架技术。

三、现行的Hadoop推测调度对大数据挖掘的影响

采用Hadoop开源框架进行大数据挖掘，具有较多的便利条件：Hive的使用可以简化数
据挖掘程序的编写，只需要掌握普通SQL操作即可进行程序编写；基于HDFS和MapReduce
的分布式特点，数据挖掘任务可以在多台机器、不限地域的情况下实施，缩短了挖掘时间，
提高了挖掘效率。但是，Hadoop对分布式任务进行推测调度的算法上存在效率问题【7】，下
面对该调度进行概要分析。

a．为防止任务因机器故障、程序意外中断引起的任务执行时间过长的问题，Hadoop

启用了推测调度，即启用新节点对卡壳任务进行重新执行；

b．对于每一个运行在节点上的TaSk，其执行剩余时间=(1．当前进度)／任务平均计算速

度，其中任务平均计算速度=当前进度／执行时间；

c．根据b对所有协l(执行剩余时间进行排序，选出最大的隧k，若其平均计算速度<

其它任务平均速度，则对该任务进行推测，启用新节点执行该节点的任务：

d．当推测节点任务执行完毕后，强制结束执行同任务节点进程。

上述过程在同构环境切多任务运行的情况下，可以一定程度避免硬件故障，程序bug
对整个M印Reduce的影响。但其存在下述可能的推测调度缺陷：1．由于启动新节点重复执
行某任务，会造成同时存在2个以上节点执行同样任务，形成资源浪费；2．当在异构环境下
(硬件机器厂商不同、运行操作系统差异、机器性能差异等)，任务节点的资源性能并不等
同，以上述标准判断是否需要启动推测调度，会出现较大误差，形成无效的调度，从而使得
新任务得不到节点进行任务执行；3．Had00p针对Reduce阶段任务划分为复制、排序、归并，
并规定每一阶段占据1／3进度，然而，统计表明，复制阶段最消耗时间和资源，明显存在不
合理调度。

·

针对这些问题，本文在SALS算法基础上进行改进，从而提高Had00p的推测调度效率，

减少重复任务，加快MapReduce的执行。

四、采用改进SALS算法对Hadoop推测调度调优

SALS算法原本用于临近节点搜索，首先确定节点集合，然后根据权重与节点间举例建
立联系图。这里，我们选取节点集合节点的判定，在第二阶段根据Had00p的推测调度进行
修改。

(1)对所有运行TaSk节点进行排队，形成协kQueue，该队列保存Slave节点任务的索

引，以节省空间；

(2)根据历史平均速率，对空闲节点进行排队，速率高节点在队列头部，从未运行过节

点速率为所有空闲节点平均速率，插入到队列中，形成FreeQueue；

(3)对佻kQueue进行动态排队，每1分钟1次，并对队尾节点进行判定：

a) 运行时间超过其它节点运行时间的1．5倍；
b) 若为非Reduce任务，任务进度与上次更新差别在10％以内；
c) 若为Reduce任务，根据Shu甩e数据量更新进度，任务进度与上次更新差别在

lO％以内。

(4)符合(3)．a且符合(3)-b或(3)_c时，对队尾任务启动新节点进行执行，立即结束当前

节点并做标记，形成BugQueue以各检查节点状态。

62

五、实验验证

为检验上述算法的有效性，启用l台机器作为主节点(2G内存，80G存储，Ub岫tu oS)，
4台从属节点，分别为1G，256M，256M，512M内存，两个Ubuntu OS，两个Red Hat OS，

进行试验。先后部署Had00p环境和改进推测调度的Hadoop环境，进行验证。结果如下：

实验表明，基于改进的SALS推测调度推测调度相较于基础Hadoop推测调度能提高40％
左右时间，达到了改进目的。采用该改进的SALS算法后，可以减少重复任务的执行数量并
及时释放可能存在问题节点以各检查。合理更新Reduce任务进度，减少出现活跃任务节点
被关闭现象。加强推测调度的准确性，对节点资源进行高效利用，提高大数据挖掘的效率。

六、结束语

移动互联网时代，大数据技术在数据挖掘方面起到的作用越发重要。针对其中可以优化
改进的流程和技术环节还有许多可以深究之处。基于改进的SALS算法优化的推测调度，在

流程方面优化了大数据挖掘，提高了Had00p推测调度的准确性和有效性。除此之外，大数
据查询优化、大数据不同架构之间的融合使用等均值得进一步研究，笔者与各位科技工作者
共勉。

◆考文献：

【1l马建光，姜巍．大数据的概念、特征及其应用【J】．国防科技，2013，3412)：10-17．

【21葛中泽，夏小翔．基于资源池的数据访问模式的探讨【J】．科学技术与工程，2012，12(33)：9066．∞60．

【3】_吉根林，赵斌．面向大数据的时空数据挖掘综述【J】．南京师大学报。2014，37(1)：1．7．

【4】http：／／矗orm．incubatoLapache．org，http：／／incubatoLapache．o唱／主4．

【51辛晃·易兴辉，陈震宇．基于Hadoop+MPP架构的电信运营商网络数据共享平台研究【J】．电信科学，2014(4)：

135．145．

【6】张常淳．基于MapReduce的大数据连接算法的设计与优化．中国技术大学，2014．4．
【7】周扬．Had∞p平台下调度算法和下载机制的优化．中南大学，2012．5．

胡立强男，1975年生，河北人石家庄人，硕士，中国移动通信集团设计院有限公司河北分公司，高级工

程师，主要研究方向移动通信支撑网、IP承载网等，11年移动通信设计经验。

