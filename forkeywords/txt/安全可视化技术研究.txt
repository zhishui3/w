

引言

当前信息网络的应用日益广泛，对信息网络的依

赖和信息网络的脆弱性使得因安全破坏导致的损失和

影响十分巨大，信息网络安全技术成为重要的研究领
域。随着网络安全技术的发展，目前又在该领域发展

出安全可视化技术分支，并成为近年来的研究热点。

1 研究现状

网络安全技术的发展和应用，使得人们获得了大
量安全相关的信息。可视化技术在多个研究领域已得

到成功应用，人们认识到通过可视化表示，可以利用人

的视觉处理能力，使人们更容易理解对象，减少在认识
全局或局部结构时所面临的认知上的负担，辅助人们

察觉到现象和规律，从而能从众多信息中迅速、准确的

作出分析和判断。随着安全相关信息的增多，人们也
开始将可视化技术与安全技术结合起来，利用可视化

技术来辅助解决安全问题，提高应对复杂安全形势的

能力。近几年来研究安全可视化技术的单位和项目逐
渐增多，从2004年起国际上每年召开一次“计算机安

全可视化技术”会议(简称VizSEC)，用以促进安全可
视化技术的研究发展。

网络可视化技术在上世纪末和本世纪初得到较快

发展，主要用以表现网络基础设施及网络流量。低层
次的可视化包括网络地理映射图、设备逻辑图、X—y

图／饼状图／柱状图上的流量等级表示法、数字化／颜色

化链路的连通性图，以及包级别的网络模拟动画(最好
的例子就是OPNET和Nam)。高层次的可视化包括

Lumeta的peacock图(它在与地理无关的自身空间中

展示了Intemet)和CAIDA的SKrlTER图(它展示了伸

收稿日期：2008．01．09

向极点的经线图上射出的对等连接)。另外，表示网络
设备及主机状态、性能、资源利用也常用可视化的图形

方式表示。

随着网络可视化和计算机安全技术的发展，二者
逐渐结合起来。1999Harris公司提出NVT网络漏洞扫

描工具，它能够形象地图示出正在研究的网络拓扑，并
结合前期扫描和脆弱性数据库生成一个漏洞评估窗

口。2000年，Hosmer H．针对安全风险研究建议了一

些形象的符号，以便更好地向用户表示安全事件。

入侵检测系统(IDS)是计算机网络安全系统中很

重要的组成部分。2001年，P．Varner和J．Knight研
究认为，由于可视化将本质上连续的IDS报警过程转
化成了视觉感知的并行过程，可视化势必将是IDS的

下一个关注焦点。最初的可视化方法主要集中在用简

单的比例尺和颜色表示来指明威胁的状态或级别，可
以提供基本的图形化用户接口，但不能满足分析的需

要。现在对IDS的事件、报警等信息进行可视化的研
究正在深入。

2004、2005年以后，出现了较多的安全可视化系

统，其中也包括IDS的可视化工具。

加利福尼亚大学开发了PortVis系统，对网络流量
使用2D plot图进行可视化用于显示和网络安全紧密
相关的端口行为。Stephen IJau．在“The Spinning Cube
of Potential Doom”中将源IP、目的IP、端口映射在3D

plot图中的轴上，将网络行为的数量用颜色交互式地
显示在plot上，从而使某些攻击的端口扫描变得十分

清晰。美Virginia州立大学开发了Portall可视化工
具。针对恶意的通信模式，可以使用户为所监视机器上

的通信进程和进程所参与的网络事件之间建立联系，

2∞S年9月

王衷霞等：安全可视化技术研究

，7l·

以发现入侵。VisFlowConnect系统使用一种简单的平

身、资源、漏洞、攻击事件等等，如何表现出它们之问的

行坐标将流入／流出的网络流数据可视化为主机或域

关系，如何能在众多的元素中显示出用户关心的信息、

之间的连接，平行坐标技术现在广泛地应用在绘制高
维数据上。美Maryland Baltimore County大学开发了

如何既能清晰地获知网络的安全状态又能方便地获取
细节信息等等。我们对目前国际上在安全态势感知可

IDTK(Intrusion Detection toolkit)，是一个针对人侵检
测信息可视化的工具，可以帮助用户从人侵检测系统
和防火墙日志等提供的大量复杂文本数据中寻找到攻

视化领域中开展的重要项目进行了研究分析。
2．1

NVisionIP

NVisionIP是由美国的超级计算应用中心(NCSA)

击的线索，用户对显示结果可以进彳亍定制。美国匿北

和伊和诺伊大学联合开发的，其目的是通过将大型复

大学开发的IDGraphs是交互式的可视化系统。使用

histographs技术总结出大量流级别的的痕迹。用户可
以交互式地调阅这些总结视图，对加亮可疑的痕迹进

行分析；开发者已经将此应用于实际，成功地检测和分
析出了大量攻击和异常，包括端口扫描、蠕虫爆发和一
些分布式的攻击等。VisualFirewaU是Georgia Teeh大
学开发的一种可视化防火墙，该工具的主要特点在于
易用性和对防火墙数据及IDS警报数据的整合使用，

杂网络中流进／流出每台机器的数据流进行可视化。帮
助使用者“看到”安全事件，从而增加系统的安全性。

经过分析，我们认为该系统有如下特点：

1)在数据源上选择了Nemow，能够涵盖很多的安

全问题。

Netflow是记录路由器、交换机流量的服务。Net-
Flow以“流(flow)”为计算流量的基本单位，“流”定义

为一段时间内一系列相互关联的包。由于除了某些不

使用户通过观察多个视匿来全方位地了锯两络状态，
保证了工具本身的安全性；不过该软件对于大型网络

产生网络流量的安全事件(如不会繁殖的软盘病毒)
之外，绝大多数安全事件都会留下经过特殊主机端El

的支持也还不够。

随着安全技术的发展，安全信息的增多，包括原始

的“流”，因此记录下了某段时间内两台机器间某个特
定接口的流信息，可以追踪很多安全事件在流层次的

的流量信息、安全设备产生的安全事件、安全告警信息

特征，例如端口扫描、DoS攻击、botnets以及很多非授

以及其它和安全相关的信息，使得安全信息的处理和
显示越来越困难。为了更好地应对网络安全工作的挑

战以及成功地将信息可视化出来，研究者开始认识到

态势感知的重要性。2006年VizSEC会议将主题定为

“有效的]ntemet安全态势感知”。出现了一些安全态
势感知可视化相关的研究项目，试图从高层对安全进

行可视化，表现多种安全信息的相关性、建立全局的安
全视图。

2 安全态势感知的可视化

权服务等。NvisionIP将来自多个内部路由器所同时输

出的NetFlows合并为一个面向所有网络流的统一Net．
Flows文件。通过和基准流模式比较，很容易显示出可
疑的安全事件。

2)设计了良好的整体及层次显示结构，能够在窗

口界面中宏观地了解整个网络的状况，还能够深入多
个层面来观察机器子网以及各个机器与安全相关的属

性。

Nvi8ionIP图形用户界面在一个称为Galaxy View
的屏幕中全面地演示整个网络的信息，将一组完整的

态势感知被广泛接受的定义(Endsley，M．R．

B类地址空间呈现在一张256×256的网格中，其中的

(1988))是对由一定时间和空间形成的环境中的元素
的感觉(perception)，对这些元素意义的理解(eompre-
hension)和对它们在近期状态的预测(projection)。安
全态势感知是指安全管理员或网络战指挥员形成网络

空间安全状态“全局视图”的过程。

安全态势的形成要经过信息的采集、与分析阶段，
经过从数据、信息到知识的过程，之后获得的态势信息

已经不是直接的网络数据或者初始的安全告警。如何

经过恰当的表示。使得用户能够直观、正确地理解安全
态势，辅助安全态势头脑模型的形成，形成能够辅助管

理员决策的知识，就需要对安全态势进行有效的表示。
对安全态势的可视化表示面临着许多需要解决的

难题，包括如何表现大量的安全相关元素、诸如网络本

每个点(戈，Y)代表了相应IP地址的主机，图中的z轴

代表子网网段，Y轴代表主枧。同时，有硬种不同层次
的放大能力：①小多网视图(SMV)一一从Galaxy View
到网络中IP地址的一个子集；②机器视图(MV)一一

从IP地址的一个子集到一个特定的IP地址，观察到
其中的子网络以及与安全事件相关的某台机器的属性

包括某个特定协议或端口数据传输的统计信息等。

3)显示流的多种信息，并且提供灵活的过滤功能。

NvisionIP会显示出IP地址的一个选定子集、子网
或多个子网中的详细端口流量信息，包括统计信息，例

如IP在NetFlow文件中出现的次数、IP在耳的流申出

现的次数，IP在源流中出现的次数等。NvisionlF还可
以通过过滤面板对需要显示具体属性进行设置，包括

+!!

竺!苎量兰兰兰兰兰竺兰±!!垦兰兰兰童兰兰堡

!型：竺耋

臣

IP地址类型(默认是所有IP)、行为类型(默认是流连
接教)、m议类型、端口类型等+从而可以根据需要方便
地选择用户所关心的信息。

2)通过将三维的安全属性映射到二维的图形上，

实现了一种更加主持用户视觉态势感知的表示方法。

通过研究．开发者发现简单地将三种属性分别对

4)精心设计的硅示元素，可有效地对不同特征进

应于传统三维笛卡尔坐标系中的各个坐标轴，when由

行可视化表示。

在NVisionlP的可视化纽件巾使用了彩色网格、柱

状囤以及连接图．其中选择有色住就图表示预定义知

名端口和动态未注册端口上的衍i量，这些图形元素都
针对该应用做了特别的修改，对包括尺寸、形状、颜色
等在内的可用性均经过专家的测试。

2 2

VisAlert

VisAlert是Utah大学制对网络人侵检测提出的一

种新颖的可视化工具，其目的是通过表现安全事件的

关联．增强用户对复杂网络环境态势感知的能力。

v…AI rl不做事件的收集和分析，而足专fq{-f对可视化

提供支持。

经过分析，我们认为该系统有如下特点：
1)该系统表现的是安全警报之间的关联，支持用

户对安全态势的感知，

VisAlert本身并不分析和处理原始数据，而将重点

放在了对现有警报之问盖联的可观化上。通过表现警
报的时间、节点和类型的联系(开发者称为w3)，支持
可视化方式下对安全警报的分析，从而支持用户对安
全态势的感知邱决策；它并不显示具体的网络数据梳

等．比较适合较高层用户．通_吐对关联关系的表现．能

够支持用户发现更高层次的安全阿题。

Time轴代表，whem由Node轴代表，whaI由Type轴代
表，从而每个警报都能够表示成坐标空问中的一个点，

有很多缺点。第，坐标系中的两个点之间可能不会
共享任何属性；第二，三维的视图也会引^视觉上的障
碍；第三，使用者的感知结果可能还需要依赖于自身的

观察角度，这只会将本来已经十分复杂的态势查得更

加不易理解。饲如图中，A警报与B警报拥有相同的
wh届性．与C警报拥有相同的what属性，而箭头所
指向的警报事件看起来却好像与前三者没有任何关系

目2传续的!罐篱卡尔裹i镕

竺!!!

!塑!!!!!!些!竺

：!!：

类型事件的频率、事件的持续时间、事件的同隔时间等
等丰富的时间信息。

2)设{f-实现丁安全事件对使命任务影响的可视化

表示。

安全事件的发生到底对使命任务产生了什么影

响，这是安全管理员以及信息战指挥员十分关心的高
层问题。该系统对该类问题做了的需求调查和分析．
在表示方面引^了相关元素，来表示对使命任务的影
响，这是安全可视化软件在任务影响表示方面的首次

尝试。具体地该系统分析并试图宴现如下表现能力：
使命美键任务和网络资源的依赖关系；支持盖键使命
任务所需资源的备份和替代者；依帻强度随任务进展

的变化情况；任务需要资源的顺序情况等。

3)采用可旋转的3D立体图形，同时显示多维向
齄，井挺供多种可规化元索柬表示多种安全数据、属性
之问的联系。

每翁惫
1。再趣?：三”掣一一

匿

开发者进行了二维的映射，网络中的IP节点投影
为『Iq圆周中二维网络拓扑上的一个点，“雕轴投影
为从指向圆周外的线段，Type轴投影为与7I附轴相交
的圆环。从而，每个警报都可以表示成(仲e．￡肌P)与
拓扑中某点(，．y)的连线。如图，圆周内包古了网络

拓扑图，最外圈上各种大小不一的弧段代表了不同的
阿络安全事件．也即whm属性，比如人侵企罔、脆弱性
状态等。在它们之间就是加m轴，也即when属性．从

网络节点指向警报类型．由内而外表明了时问的递进。

此外，具体实现时还增加了一些可视化元素，提高了用
户肘安全态势感知的能力。

3)该二维的表示方法可设进一步推广到其它卷势

感知领域的可视化中．形成一种通用的方j击：

开发者通过将三种属性进行一般化，即考虑事件

通用的类型、事件和贷源属性．给出通用的映射函数．
可用于将大量资源中相互符异的事件关联起来．为事

件关联的可视化提供一个一般化的架构。

2 3

Seeu]EScope
Sec啪Seope足AVI公司研制开发的企业级安全
事件r口『视化较件框架，作为DARPA的Cybel p曲el项

目的一部分．它的目的是设计支持安全管理员宴现网
络空间安垒态势感知的可视化表示。

经过分析，我们认为设系统有如下特点

1)设计实现了对安全事件时间模式的可视化表

示。

针对目前对时问因素表示不够的网题，该工具做
了认真地分析和需求调查，通过引^井表示多种时间

困震．来帮助用户实现安全趋势的分析、事件统计等和

时间因素有关的安全信息的表示。包括用户可选择的
时间表示粒度、时间跨度、时问信息标注、特定事件时

间显示，以及安全事件类型与时间的关系、日标与时问

的关系、攻击源与时间的关系、事件发生的顺序、特定

